%7B%22type%22%3A%22query%22%2C%22selects%22%3A%5B%7B%22type%22%3A%22select%22%2C%22expr%22%3A%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22main%22%2C%22column%22%3A%22code%22%7D%2C%22alias%22%3A%22code%22%7D%2C%7B%22type%22%3A%22select%22%2C%22expr%22%3A%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22main%22%2C%22column%22%3A%22name%22%7D%2C%22alias%22%3A%22name%22%7D%2C%7B%22type%22%3A%22select%22%2C%22expr%22%3A%7B%22type%22%3A%22scalar%22%2C%22expr%22%3A%7B%22type%22%3A%22op%22%2C%22op%22%3A%22%5B%5D%22%2C%22exprs%22%3A%5B%7B%22type%22%3A%22op%22%2C%22op%22%3A%22array_agg%22%2C%22exprs%22%3A%5B%7B%22type%22%3A%22case%22%2C%22cases%22%3A%5B%7B%22when%22%3A%7B%22type%22%3A%22op%22%2C%22op%22%3A%22is%20not%20null%22%2C%22exprs%22%3A%5B%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22transactions%22%2C%22column%22%3A%22meter_end%22%7D%5D%7D%2C%22then%22%3A%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22transactions%22%2C%22column%22%3A%22meter_end%22%7D%7D%5D%2C%22else%22%3Anull%7D%5D%2C%22orderBy%22%3A%5B%7B%22expr%22%3A%7B%22type%22%3A%22case%22%2C%22cases%22%3A%5B%7B%22when%22%3A%7B%22type%22%3A%22op%22%2C%22op%22%3A%22is%20not%20null%22%2C%22exprs%22%3A%5B%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22transactions%22%2C%22column%22%3A%22meter_end%22%7D%5D%7D%2C%22then%22%3A0%7D%5D%2C%22else%22%3A1%7D%7D%2C%7B%22expr%22%3A%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22transactions%22%2C%22column%22%3A%22date%22%7D%2C%22direction%22%3A%22desc%22%2C%22nulls%22%3A%22last%22%7D%5D%7D%2C1%5D%7D%2C%22limit%22%3A1%2C%22from%22%3A%7B%22type%22%3A%22table%22%2C%22table%22%3A%22custom.ts4.transactions%22%2C%22alias%22%3A%22transactions%22%7D%2C%22where%22%3A%7B%22type%22%3A%22op%22%2C%22op%22%3A%22%3D%22%2C%22exprs%22%3A%5B%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22transactions%22%2C%22column%22%3A%22customer%22%7D%2C%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22main%22%2C%22column%22%3A%22_id%22%7D%5D%7D%7D%2C%22alias%22%3A%22latest_reading%22%7D%2C%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22select%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22expr%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22scalar%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22expr%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22field%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22tableAlias%22%3A%20%22tariff_meter_rates%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22column%22%3A%20%22price%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22limit%22%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22from%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22table%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22table%22%3A%20%22custom.ts4.tariff_meter_rates%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22alias%22%3A%20%22tariff_meter_rates%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22where%22%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22op%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22op%22%3A%20%22%3D%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22exprs%22%3A%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22field%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22tableAlias%22%3A%20%22main%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22column%22%3A%20%22tariff%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22type%22%3A%20%22field%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22tableAlias%22%3A%20%22tariff_meter_rates%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22column%22%3A%20%22tariff%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22alias%22%3A%20%22tariff_price%22%0A%20%20%20%20%20%20%20%20%7D%2C%7B%22type%22%3A%22select%22%2C%22expr%22%3A%7B%22type%22%3A%22field%22%2C%22tableAlias%22%3A%22main%22%2C%22column%22%3A%22_id%22%7D%2C%22alias%22%3A%22_id%22%7D%5D%2C%22from%22%3A%7B%22type%22%3A%22table%22%2C%22table%22%3A%22custom.ts4.customers%22%2C%22alias%22%3A%22main%22%7D%2C%22groupBy%22%3A%5B%5D%2C%22orderBy%22%3A%5B%5D%2C%22limit%22%3A1000%7D
